<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <title>Dados Água SP</title>
  </head>
  <body>
    <h1>Clientes Premium</h1>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script>
      $(function () {

        var clients;

        $.getJSON('data/clientesPremiumSabesp.json', function( data ) {
          clients = data;
          showList();
        });

        $(window).on('hashchange', function () {
          if (!location.hash || location.hash === '#all') {
            showList();
          } else {
            showDetail();
          }
        });

        function showList() {
          var items = [];
          $.each(clients, function( key, val ) {
            if (val.agua) {
              items.push('<a href="#' + (val.id - 1) + '">' + val.nome + '</a><br>');
            }
          });
          $('#data').html(items.join(''));
		  $("#cliente_premium").empty();
		  $("#familias").empty();
		  $("#dados_adicionais").empty();
        }

        function showDetail() {
          var client = clients[location.hash.substring(1)];
         

           var nome_cliente_premium = client.nome;
           var consumo_agua = client.agua;
           var CONSUMO_POR_FAMILIA= 15.64;
           var FIGURAS_POR_FAMILIA=1;
           var numero_de_familias = Math.trunc(consumo_agua/CONSUMO_POR_FAMILIA/FIGURAS_POR_FAMILIA);
		   $("#cliente_premium").html("<p>Nome da Empresa: "+nome_cliente_premium+"</p>");
           $("#dados_adicionais").html("<p>O total consumido por esta empresa foi de :"+ client.agua+" m³.</p>"+
		   "<p>Foi considerado um consumo médio familiar mensal de "+CONSUMO_POR_FAMILIA+
		   "m³, cuja fonte pode ser encontrada <a href='http://brasil.elpais.com/brasil/2015/02/12/politica/1423765554_696443.html' target='blank'>aqui</a></p>"+
		   "<p>Cada casa representa "+FIGURAS_POR_FAMILIA+" família(s) de 4 pessoas.</p>"+
		   "<p>Para a empresa em questão, seu consumo seria suficiente para abastecer "+ numero_de_familias+" famílias, ou seja, "+ numero_de_familias*4 +" pessoas.");
		   $('#data').html('<p><a href="#all">Voltar</a></p>');
           for (i = 0; i < numero_de_familias; i++) { 
              $('#familias').append("<img src='./svg/family24.svg' width='50' style='margin-right:5px;'/>");
			  
           }
        };

      });
    </script>
	
	<h3 id="cliente_premium"></h3>
	
	<div id="dados_adicionais">
	
	</div>
	
	<div id="data">
	</div>
     
	
	<div id="familias">	
	</div>	
	
	<br>
	<div>Icons made by <a href="http://www.freepik.com" title="Freepik">Freepik</a> 
	from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a>    
	is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" 
	title="Creative Commons BY 3.0">CC BY 3.0</a></div>
  </body>
</html>
