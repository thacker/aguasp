<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <title>Dados √Ågua SP</title>
  </head>
  <body>
    <h1>Clientes Premium</h1>
    <div id="data"></div>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script>
      $(function () {

        var clients;

        $.getJSON('data/clientesPremiumSabesp.json', function( data ) {
          clients = data;
          showList();
        });

        $(window).on('hashchange', function () {
          if (!location.hash || location.hash === '#all') {
            showList();
          } else {
            showDetail();
          }
        });

        function showList() {
          var items = [];
          $.each(clients, function( key, val ) {
            if (val.agua) {
              items.push('<a href="#' + (val.id - 1) + '">' + val.nome + '</a><br>');
            }
          });
          $('#data').html(items.join(''));
        }

        function showDetail() {
          var client = clients[location.hash.substring(1)];
          $('#data').html('<br><a href="#all">Voltar</a>');

           var nome_cliente_premium = client.nome;
           var consumo_agua = client.agua;
           var CONSUMO_POR_FAMILIA= 264;
           var FIGURAS_POR_FAMILIA=10
           var numero_de_familias = Math.trunc(consumo_agua/CONSUMO_POR_FAMILIA/FIGURAS_POR_FAMILIA);
		   $("#familias").empty();
		   $("#cliente_premium").html(nome_cliente_premium);
           for (i = 0; i < numero_de_familias; i++) { 
              $('#familias').append("<img src='./svg/family24.svg' />");
           }
        };

      });
    </script>
	
	<h3 id="cliente_premium"></h3>
    <div id="familias">	
	</div>	
	
  </body>
</html>
